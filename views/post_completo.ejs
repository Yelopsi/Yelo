<!DOCTYPE html>
<html lang="pt-br">
<head>
    <title><%= post.titulo %> | Blog Yelo</title>
    <meta name="description" content="<%= post.conteudo.substring(0, 160) %>">
    <%- include('partials/head') %>
</head>
<body>

<%- include('partials/header') %>

<main class="artigo-main ruido">

    <article class="artigo-wrapper">

        <!-- HEADER -->
        <header class="artigo-header">
            <% if (post.tags && post.tags.length) { %>
                <span class="categoria-tag"><%= post.tags[0] %></span>
            <% } %>

            <h1 class="artigo-titulo"><%= post.titulo %></h1>

            <div class="artigo-meta">
                <a href="/<%= post.autor?.slug || '#' %>" class="autor-info">
                    <img
                        src="<%= post.autor?.fotoUrl ? formatImageUrl(post.autor.fotoUrl) : 'https://placehold.co/48x48' %>"
                        class="autor-foto"
                        alt="Foto do autor"
                    >
                    <div class="autor-texto">
                        <strong>Psi. <%= post.autor?.nome || 'Equipe Yelo' %></strong>
                        <span>Ver perfil profissional</span>
                    </div>
                </a>

                <div class="data-leitura">
                    <%= new Date(post.created_at).toLocaleDateString('pt-BR', {
                        day: 'numeric',
                        month: 'long',
                        year: 'numeric'
                    }) %>
                    <br>
                    <span>~<%= Math.ceil(post.conteudo.split(' ').length / 200) %> min de leitura</span>
                </div>
            </div>
        </header>

        <!-- IMAGEM -->
        <% if (post.imagem_url) { %>
        <figure class="artigo-img-container">
            <img
                src="<%= post.imagem_url %>"
                alt="<%= post.titulo %>"
                class="artigo-img"
            >
        </figure>
        <% } %>

        <!-- TEXTO -->
        <section class="artigo-conteudo">
            <% post.conteudo.split('\n').forEach(p => { %>
                <% if (p.trim()) { %>
                    <p><%= p %></p>
                <% } %>
            <% }) %>
        </section>

        <!-- CTA EDITORIAL -->
        <footer class="artigo-cta">
            <p>
                Ler ajuda a entender.<br>
                Fazer terapia ajuda a transformar.
            </p>

            <div class="cta-acoes">
                <a href="/blog" class="btn-secundario">
                    ← Voltar ao Blog
                </a>

                <% if (post.autor) { %>
                <a href="/<%= post.autor.slug %>" class="btn-cta-principal">
                    Agendar com este psicólogo
                </a>
                <% } %>
            </div>
        </footer>

    </article>

</main>

<%- include('partials/footer') %>

</body>
</html>
