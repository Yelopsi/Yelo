<!-- Container principal do F√≥rum -->
<div id="forum-container">

    <!-- 1. TELA PRINCIPAL (FEED DE POSTS) -->
    <div id="forum-feed-view">
        <div class="main-header">
            <div class="header-content">
                <h1>F√≥rum da Comunidade</h1>
                <p>Troque experi√™ncias, discuta casos e interaja com outros profissionais.</p>
            </div>
        </div>

        <!-- AVISO DE REGRAS DA COMUNIDADE -->
        <div class="forum-guidelines-box">
            <div class="guidelines-icon">‚öñÔ∏è</div>
            <div class="guidelines-content">
                <strong>Regras da Comunidade:</strong>
                <ul style="margin: 8px 0 0 20px; padding: 0; font-size: 0.9rem; color: #555;">
                    <li><strong>Respeito acima de tudo:</strong> Debates s√£o bem-vindos, ataques pessoais n√£o ser√£o tolerados.</li>
                    <li><strong>Sigilo profissional √© inegoci√°vel:</strong> Ao discutir casos, sempre anonimize todos os dados que possam identificar um paciente.</li>
                    <li><strong>Conte√∫do construtivo:</strong> Evite autopromo√ß√£o direta. O foco √© a troca de conhecimento e suporte m√∫tuo.</li>
                    <li><strong>Direitos Humanos:</strong> Discursos de √≥dio, discrimina√ß√£o ou que violem os direitos humanos resultar√£o em banimento.</li>
                </ul>
            </div>
        </div>

        <div class="widget">
            <div class="forum-controls">
                <div class="forum-search-bar">
                    <input type="text" id="forum-search-input" placeholder="Buscar por t√≠tulo ou palavra-chave...">
                </div>
                <div class="forum-tabs" style="display: flex; gap: 15px;">
                    <span class="tab-item" data-filter="populares">Populares</span>
                    <span class="tab-item active" data-filter="recentes">Recentes</span>
                    <span class="tab-item" data-filter="meus_posts">Meus Posts</span>
                </div>
            </div>
            <!-- Container onde os cards dos posts ser√£o renderizados -->
            <div id="forum-posts-container">
                <!-- Loader/Spinner -->
                <div class="loader-wrapper"><div class="loader-spinner"></div></div>
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <button id="btn-load-more-posts" class="btn btn-secundario hidden">Mostrar mais</button>
            </div>
        </div>
    </div>

    <!-- 2. TELA DE POST √öNICO (Inicialmente oculta) -->
    <div id="forum-post-view" class="hidden">
        <!-- O conte√∫do ser√° gerado via JS -->
    </div>

</div>

<!-- 3. BOT√ÉO DE A√á√ÉO FLUTUANTE (FAB) -->
<button id="forum-fab" title="Criar Novo T√≥pico">+</button>

<!-- 4. MODAL PARA CRIAR NOVO POST (Inicialmente oculto) -->
<div id="forum-create-modal" class="custom-modal-overlay" style="display: none;">
    <div class="custom-modal-box">
        <button class="modal-close" id="forum-modal-close-btn">‚úï</button>
        <h3 style="margin-top:0;">Criar Nova Discuss√£o</h3>
        <form id="forum-create-form">
            <div class="form-group">
                <label for="post-title">T√≠tulo</label>
                <input type="text" id="post-title" name="title" required maxlength="150" placeholder="Qual a sua d√∫vida ou ideia?">
            </div>
            <div class="form-group">
                <label for="post-category">Categoria</label>
                <select id="post-category" name="category" required>
                    <option value="" disabled selected>Selecione um tema...</option>
                    <option value="Discuss√£o de Casos (Intervis√£o)">Discuss√£o de Casos (Intervis√£o)</option>
                    <option value="Burocracia e Legisla√ß√£o (CRP/CFP)">Burocracia e Legisla√ß√£o (CRP/CFP)</option>
                    <option value="Indica√ß√µes e Encaminhamentos">Indica√ß√µes e Encaminhamentos</option>
                    <option value="Ferramentas e Refer√™ncias">Ferramentas e Refer√™ncias</option>
                    <option value="Marketing e Carreira">Marketing e Carreira</option>
                    <option value="Sala de Caf√© (Off-topic)">Sala de Caf√© (Off-topic)</option>
                </select>
            </div>
            <div id="forum-disclaimer" class="forum-disclaimer-box hidden">
                <strong>Aten√ß√£o ao Sigilo Profissional:</strong> Lembre-se do C√≥digo de √âtica. Nunca cite nomes, locais ou dados que possam identificar seus pacientes.
            </div>
            <div class="form-group">
                <label for="post-content">Conte√∫do</label>
                <textarea id="post-content" name="content" rows="8" required placeholder="Descreva com mais detalhes..."></textarea>
            </div>
            <div class="form-group-checkbox" style="margin-top: 15px;">
                <input type="checkbox" id="post-anonymous" name="isAnonymous">
                <label for="post-anonymous">Publicar como An√¥nimo</label>
            </div>
            <div style="display: flex; justify-content: flex-end; margin-top: 20px;">
                <button type="submit" id="forum-submit-post-btn" class="btn btn-principal">Publicar</button>
            </div>
        </form>
    </div>
</div>


<!-- 5. TEMPLATES PARA RENDERIZA√á√ÉO DIN√ÇMICA -->

<!-- Template para o card de post no feed -->
<template id="forum-post-card-template">
    <div class="forum-post-card">
        <div class="post-votes">
            <button class="support-btn" title="Apoiar">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
            </button>
            <span class="post-votes-count">0</span>
            <span class="post-category-mobile"></span>
        </div>
        <div class="post-content-summary">
            <div class="post-meta">
                <span class="post-category"></span><span class="post-author"></span><span class="post-time"></span>
            </div>
            <h4 class="post-title"></h4>
            <p class="post-snippet"></p>
            <div class="post-footer">
                <span class="post-comments-count">üí¨ 0 Coment√°rios</span>
                <div class="post-actions-right">
                    <button class="delete-btn hidden" title="Excluir meu post" style="background:none; border:none; color:#d32f2f; cursor:pointer;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="3 6 5 6 21 6"></polyline>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                            <line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line>
                        </svg>
                    </button>
                    <button class="report-btn">Denunciar</button>
                </div>
            </div>
        </div>
    </div>
</template>

<!-- Template para a view de post completo -->
<template id="forum-full-post-template">
    <div> <!-- Wrapper principal -->
        <div class="main-header">
            <div class="header-content">
                <button id="forum-back-to-feed-btn" style="background: none; border: none; color: #fff; cursor: pointer; padding: 0; margin-bottom: 20px; font-size: 0.95rem; font-weight: 500;">&larr; Voltar ao F√≥rum</button>
                <h1 class="full-post-title"></h1>
                <div class="post-meta" style="color: #ffffff;">
                    <span class="category-wrapper"><strong class="full-post-category"></strong> &bull; </span><span class="author-wrapper">Por <strong class="full-post-author"></strong></span>
                </div>
            </div>
        </div>

        <div class="forum-post-layout">
            <div class="forum-post-main">
                <div class="widget">
                    <div class="full-post-content"></div>
                    <div class="full-post-actions">
                        <button class="support-btn" title="Apoiar">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
                            <span class="post-votes-count">0</span>
                        </button>
                        <button class="delete-btn-full hidden" style="background:none; border:1px solid #d32f2f; color:#d32f2f; padding:8px 15px; border-radius:25px; cursor:pointer; font-weight:600;">Excluir Post</button>
                        <button class="report-btn">Denunciar Post</button>
                    </div>

                    <hr style="margin: 30px 0;">

                    <div class="comment-section">
                        <h3>Coment√°rios</h3>
                        <form id="comment-form">
                            <div class="form-group">
                                <textarea id="comment-content" rows="3" placeholder="Adicionar um coment√°rio..." required></textarea>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div class="form-group-checkbox">
                                    <input type="checkbox" id="comment-anonymous">
                                    <label for="comment-anonymous">Comentar como An√¥nimo</label>
                                </div>
                                <button type="submit" class="btn btn-principal">Comentar</button>
                            </div>
                        </form>
                        <div id="comment-thread" class="comment-thread">
                            <!-- Coment√°rios ser√£o renderizados aqui -->
                        </div>
                        <div style="text-align: center; margin-top: 20px;">
                            <button id="btn-load-more-comments" class="btn btn-secundario hidden">Mostrar mais coment√°rios</button>
                        </div>
                    </div>
                </div>
            </div>
            <aside class="forum-post-sidebar">
                <div class="widget">
                    <h3 style="margin-top:0;">T√≥picos Populares</h3>
                    <div id="related-posts-container"></div>
                </div>
            </aside>
        </div>
    </div>
</template>

<!-- Template para um √∫nico coment√°rio -->
<template id="forum-comment-template">
    <div class="comment-card">
        <div class="comment-header">
            <strong class="comment-author"></strong>
            <span class="comment-time"></span>
        </div>
        <p class="comment-body"></p>
        <div class="comment-actions">
            <button class="comment-like-btn" title="Apoiar coment√°rio">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
                <span class="comment-likes-count">0</span>
            </button>
            <button class="comment-reply-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>
                Responder
            </button>
            <button class="report-btn inline-report">Denunciar</button>
        </div>
        <div class="comment-replies-container"></div>
    </div>
</template>

<!-- Template para um item na sidebar de posts relacionados -->
<template id="forum-related-post-template">
    <a href="#" class="related-post-item">
        <div class="related-post-content">
            <span class="related-post-category"></span>
            <h5 class="related-post-title"></h5>
        </div>
        <div class="related-post-meta">
            <span class="related-post-votes"></span>
            <span class="related-post-comments"></span>
        </div>
    </a>
</template>